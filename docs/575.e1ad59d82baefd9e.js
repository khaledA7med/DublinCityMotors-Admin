"use strict";(self.webpackChunkDublinCityMotors=self.webpackChunkDublinCityMotors||[]).push([[575],{3575:(U,p,l)=>{l.r(p),l.d(p,{OffersModule:()=>R});var m=l(177),o=l(4341),t=l(8699);let h=(()=>{class n{formatBytes(e,i){if(0===e)return"0 Bytes";const r=i<=0?0:i||2,a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(r))+" "+["Bytes","KB","MB","GB"][a]}dateStructFormat(e){return{year:(e=new Date(e)).getFullYear(),month:e.getMonth()+1,day:e.getDate()}}dateFormater(e){let i="";return e&&(i=`${e.year}-${e.month}-${e.day}`.toString()),i}reportViewer(e,i){const s=window.open(e,"_blank",`width=${window.screen.availWidth}, height=${window.screen.availHeight}`),r=`\t\t\n\t\t\t\t\t\t<!DOCTYPE html>\n\t\t\t\t\t\t<html lang="en"  width="100vw">\n\t\t\t\t\t\t\t<head>\n\t\t\t\t\t\t\t\t<title>${i}</title>\n\t\t\t\t\t\t\t\t<link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">\n\t\t\t\t\t\t\t\t<style>\n\t\t\t\t\t\t\t\tbody {height: 98vh;}\n\t\t\t\t\t\t\t\t.myIFrame {\n\t\t\t\t\t\t\t\tborder: none;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t</style>\n\t\t\t\t\t\t\t</head>\n\t\t\t\t\t\t\t<body>\n\t\t\t\t\t\t\t\t<iframe\n\t\t\t\t\t\t\t\tsrc="${e}"\n\t\t\t\t\t\t\t\tclass="myIFrame justify-content-center"\n\t\t\t\t\t\t\t\tframeborder="5"\n\t\t\t\t\t\t\t\twidth="100%"\n\t\t\t\t\t\t\t\theight="99%"\n\t\t\t\t\t\t\t\treferrerpolicy="no-referrer-when-downgrade"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</iframe>\n\t\t\t\t\t\t\t</body>\n\t\t\t\t\t\t</html>\n\n\t\t`;s?.document.write(r)}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var b=l(7402),u=l(6554),_=l(3587),g=l(1626);let v=(()=>{class n{constructor(e){this.http=e,this.env=_.c.apiUrl}getAllOffers(){return this.http.get(this.env+"offers/getActiveOffers")}addOffers(e){return this.http.post(this.env+"offers/addOffer",e)}updateOffers(e){return this.http.put(this.env+"offers/updateOffer",e)}static#t=this.\u0275fac=function(i){return new(i||n)(t.KVO(g.Qq))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var d=l(788),k=l(1345);function F(n,f){1&n&&(t.j41(0,"div",6),t.EFF(1," Required "),t.k0s())}function y(n,f){if(1&n){const e=t.RV6();t.nrm(0,"hr",7),t.j41(1,"button",8),t.bIt("click",function(){t.eBV(e);const s=t.XpG(),r=t.sdS(2);return s.date=s.today,t.Njj(r.close())}),t.EFF(2,"Today"),t.k0s(),t.j41(3,"button",9),t.bIt("click",function(){t.eBV(e),t.XpG();const s=t.sdS(2);return t.Njj(s.close())}),t.EFF(4,"Close"),t.k0s()}if(2&n){const e=t.XpG();t.R7$(1),t.Y8G("disabled",e.disabled)}}const C=function(n){return{"is-invalid":n}};let j=(()=>{class n{constructor(e,i,s){this.changeDate=i,this.calendar=s,this.readonly=!1,this.submitted=!1,this.required=!1,this.disabled=!1,this.dateChange=new t.bkB,this.minDate=this.calendar.getToday(),this.maxDate={year:2050,month:12,day:31},e.minDate=this.calendar.getToday(),e.maxDate={year:2099,month:12,day:31},e.placement=["top-end","top-start","bottom-end","bottom-start"]}ngOnChanges(){this.date=this.model?this.model:{day:0,year:0,month:0}}get today(){return this.onDateSelect(this.calendar.getToday()),this.calendar.getToday()}onDateSelect(e){let i=this.changeDate.fromGregorian(new Date(`${e.year}-${e.month}-${e.day}`));this.dateChange.emit({gon:e,hijri:i})}static#t=this.\u0275fac=function(i){return new(i||n)(t.rXU(d.YB),t.rXU(d.a_),t.rXU(d.iF))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-date-picker"]],inputs:{model:"model",readonly:"readonly",submitted:"submitted",required:"required",disabled:"disabled",minDate:"minDate",maxDate:"maxDate"},outputs:{dateChange:"dateChange"},features:[t.Jv_([d.YB,d.a_]),t.OA$],decls:8,vars:11,consts:[[1,"input-group","input-group-sm"],["type","text","ngbDatepicker","","container","body","placeholder","yyyy-mm-dd","readonly","",1,"form-control",3,"ngModel","disabled","required","footerTemplate","minDate","maxDate","ngClass","ngModelChange","dateSelect","click"],["d","ngbDatepicker","dates","ngModel"],["type","button",1,"btn","btn-outline-secondary","bx","bx-calendar","dateTogglerBtn",3,"disabled","click"],["class","invalid-feedback fw-bold",4,"ngIf"],["footerTemplate",""],[1,"invalid-feedback","fw-bold"],[1,"my-0"],[1,"btn","btn-outline-primary","btn-sm","m-2","float-start",3,"disabled","click"],[1,"btn","btn-ghost-secondary","btn-sm","m-2","float-end",3,"click"]],template:function(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",0)(1,"input",1,2),t.bIt("ngModelChange",function(a){return s.date=a})("dateSelect",function(a){return s.onDateSelect(a)})("click",function(){t.eBV(r);const a=t.sdS(2);return t.Njj(!s.readonly&&a.toggle())}),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){t.eBV(r);const a=t.sdS(2);return t.Njj(!s.readonly&&a.toggle())}),t.k0s(),t.DNE(5,F,2,0,"div",4),t.k0s(),t.DNE(6,y,5,1,"ng-template",null,5,t.C5r)}if(2&i){const r=t.sdS(3),c=t.sdS(7);t.R7$(1),t.Y8G("ngModel",s.date)("disabled",s.disabled)("required",s.required)("footerTemplate",c)("minDate",s.minDate)("maxDate",s.maxDate)("ngClass",t.eq3(9,C,s.required&&(r.touched&&r.invalid||s.submitted&&r.invalid))),t.R7$(3),t.Y8G("disabled",s.disabled),t.R7$(1),t.Y8G("ngIf",s.required&&(r.touched&&r.invalid||s.submitted&&r.invalid))}},dependencies:[m.YU,m.bT,d.cw,o.me,o.BC,o.YS,o.vS]})}return n})();const D=["content"];function O(n,f){1&n&&(t.j41(0,"span"),t.EFF(1," Active "),t.k0s())}function x(n,f){1&n&&(t.j41(0,"span"),t.EFF(1," Not Active "),t.k0s())}function E(n,f){if(1&n){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.DNE(8,O,2,0,"span",12),t.DNE(9,x,2,0,"span",12),t.k0s(),t.j41(10,"td"),t.EFF(11),t.k0s(),t.j41(12,"th",13)(13,"button",14),t.bIt("click",function(){const r=t.eBV(e).$implicit,c=t.XpG();return t.Njj(c.editOffer(r))}),t.nrm(14,"i",15),t.k0s()()()}if(2&n){const e=f.$implicit;t.R7$(2),t.SpI(" ",e.id," "),t.R7$(2),t.SpI(" ",e.validFrom," "),t.R7$(2),t.SpI(" ",e.validUntil," "),t.R7$(2),t.Y8G("ngIf",1==e.active),t.R7$(1),t.Y8G("ngIf",0==e.active),t.R7$(2),t.SpI(" ",e.description," ")}}function G(n,f){1&n&&t.nrm(0,"span",36)}function S(n,f){if(1&n&&(t.j41(0,"button",33),t.nrm(1,"i",34),t.EFF(2," Save "),t.DNE(3,G,1,0,"span",35),t.k0s()),2&n){const e=t.XpG(2);t.R7$(3),t.Y8G("ngIf",e.submitted)}}function T(n,f){1&n&&t.nrm(0,"span",36)}function I(n,f){if(1&n&&(t.j41(0,"button",33),t.nrm(1,"i",34),t.EFF(2," Update "),t.DNE(3,T,1,0,"span",35),t.k0s()),2&n){const e=t.XpG(2);t.R7$(3),t.Y8G("ngIf",e.submitted)}}function $(n,f){if(1&n){const e=t.RV6();t.j41(0,"div",16)(1,"h4",17),t.EFF(2,"Offer Details"),t.k0s(),t.j41(3,"button",18),t.bIt("click",function(){const r=t.eBV(e).$implicit;return t.Njj(r.dismiss("Cross click"))}),t.k0s()(),t.j41(4,"form",19),t.bIt("ngSubmit",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.submitForm(s.formGroup))}),t.j41(5,"div",20)(6,"div",3)(7,"div",21)(8,"label",22),t.EFF(9,"Offer Start Date"),t.k0s(),t.j41(10,"app-date-picker",23),t.bIt("dateChange",function(s){t.eBV(e);const r=t.XpG();return t.Njj(r.setFromDate(s))}),t.k0s()(),t.j41(11,"div",21)(12,"label",22),t.EFF(13,"Offer End Date"),t.k0s(),t.j41(14,"app-date-picker",23),t.bIt("dateChange",function(s){t.eBV(e);const r=t.XpG();return t.Njj(r.setUntillDate(s))}),t.k0s()(),t.j41(15,"div",21)(16,"label",22),t.EFF(17,"Offer State"),t.k0s(),t.nrm(18,"ng-select",24),t.k0s(),t.j41(19,"div",25)(20,"label",22),t.EFF(21,"Offer Description"),t.k0s(),t.nrm(22,"textarea",26),t.k0s()()(),t.j41(23,"div",27),t.DNE(24,S,4,1,"button",28),t.DNE(25,I,4,1,"button",28),t.j41(26,"button",29),t.bIt("click",function(){t.eBV(e);const s=t.XpG();return t.Njj(s.reset())}),t.nrm(27,"i",30),t.EFF(28," Clear "),t.k0s(),t.j41(29,"button",31),t.bIt("click",function(){const r=t.eBV(e).$implicit;return t.Njj(r.dismiss("Cross click"))}),t.nrm(30,"i",32),t.EFF(31," Close "),t.k0s()()()}if(2&n){const e=t.XpG();t.R7$(4),t.Y8G("formGroup",e.formGroup),t.R7$(14),t.Y8G("items",e.state)("searchable",!0),t.R7$(6),t.Y8G("ngIf",!e.isEdit),t.R7$(1),t.Y8G("ngIf",e.isEdit)}}let w=(()=>{class n{constructor(e,i,s,r,c,a){this.messages=e,this.spinner=i,this.OffersService=s,this.modalService=r,this.appUtils=c,this.calendar=a,this.subscribe=[],this.offersData=[],this.submitted=!1,this.isEdit=!1,this.state=[{id:!0,name:"Active"},{id:!1,name:"Not Active"}]}ngOnInit(){this.getAllOffers(),this.initForm()}initForm(){this.formGroup=new o.gE({id:new o.MJ,active:new o.MJ,validFrom:new o.MJ(null),validUntil:new o.MJ(null),description:new o.MJ("")})}get f(){return this.formGroup.controls}getAllOffers(){return this.spinner.show(),this.OffersService.getAllOffers().subscribe(e=>{e&&(this.spinner.hide(),this.offersData=e)},e=>{this.spinner.hide(),this.messages.toast(e.error.message,"error")})}openOfferModal(e){this.modalService.open(e,{centered:!0,backdrop:"static",size:"lg"})}setFromDate(e){this.f.validFrom?.patchValue(this.appUtils.dateFormater(e.gon))}setUntillDate(e){this.f.validUntil?.patchValue(this.appUtils.dateFormater(e.gon))}submitForm(e){this.submitted=!0;let i=e.getRawValue();i.id?this.OffersService.updateOffers(i).subscribe(s=>{this.messages.toast(s.message,"success"),this.submitted=!1,this.getAllOffers(),this.reset()},s=>{this.submitted=!1}):this.OffersService.addOffers(i).subscribe(s=>{this.messages.toast(s.message,"success"),this.submitted=!1,this.getAllOffers(),this.reset()},s=>{this.submitted=!1})}editOffer(e){this.isEdit=!0,this.openOfferModal(this.content),e.id&&(this.f.id?.patchValue(e.id),this.f.active.patchValue(e.active),this.f.validFrom.patchValue(e.validFrom),this.f.validUntil.patchValue(e.validUntil),this.f.description.patchValue(e.description))}reset(){this.formGroup.reset()}static#t=this.\u0275fac=function(i){return new(i||n)(t.rXU(b.G),t.rXU(u.ex),t.rXU(v),t.rXU(d.Bq),t.rXU(h),t.rXU(d.iF))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-offers"]],viewQuery:function(i,s){if(1&i&&t.GBs(D,5),2&i){let r;t.mGM(r=t.lsd())&&(s.content=r.first)}},decls:29,vars:2,consts:[["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","square-spin",3,"fullScreen"],[2,"color","white"],[1,"container","home","mt-lg-5"],[1,"row"],[1,"col-12","d-flex","justify-content-end","my-4"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"bx","bx-plus","p-1"],[1,"col-md-12"],[1,"table","table-responsive","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["content",""],[4,"ngIf"],["scope","row"],[1,"btn","btn-outline-info","me-3",3,"click"],[1,"bx","bx-edit-alt"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"col-lg-4","col-md-6","col-sm-12","my-2"],["for",""],[3,"dateChange"],["placeholder","Select time","formControlName","active","bindLabel","name","bindValue","id","id","active",3,"items","searchable"],[1,"col-12","my-2"],["formControlName","description",1,"form-control"],[1,"modal-footer"],["type","submit","class","btn btn-sm btn-outline-success mx-2 d-flex align-items-center",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-outline-info","mx-2","d-flex","align-items-center",3,"click"],[1,"bx","bx-clipboard","me-1"],["type","button",1,"btn","btn-outline-danger","btn-sm","d-flex","align-items-center",3,"click"],[1,"bx","bx-x","me-1"],["type","submit",1,"btn","btn-sm","btn-outline-success","mx-2","d-flex","align-items-center"],[1,"bx","bx-save","me-1"],["class","spinner-border spinner-border-sm ms-2",4,"ngIf"],[1,"spinner-border","spinner-border-sm","ms-2"]],template:function(i,s){if(1&i){const r=t.RV6();t.j41(0,"ngx-spinner",0)(1,"p",1),t.EFF(2,"Loading..."),t.k0s()(),t.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"button",5),t.bIt("click",function(){t.eBV(r);const a=t.sdS(28);return t.Njj(s.openOfferModal(a))}),t.EFF(7," Add Offer "),t.nrm(8,"i",6),t.k0s()(),t.j41(9,"div",7)(10,"table",8)(11,"thead")(12,"tr")(13,"th",9),t.EFF(14,"#"),t.k0s(),t.j41(15,"th",9),t.EFF(16,"Offer Start"),t.k0s(),t.j41(17,"th",9),t.EFF(18,"Offer End"),t.k0s(),t.j41(19,"th",9),t.EFF(20,"Offer State"),t.k0s(),t.j41(21,"th",9),t.EFF(22,"Offer Description"),t.k0s(),t.j41(23,"th",9),t.EFF(24,"Actions"),t.k0s()()(),t.j41(25,"tbody"),t.DNE(26,E,15,6,"tr",10),t.k0s()()()()(),t.DNE(27,$,32,5,"ng-template",null,11,t.C5r)}2&i&&(t.Y8G("fullScreen",!0),t.R7$(26),t.Y8G("ngForOf",s.offersData))},dependencies:[m.Sq,m.bT,k.vr,o.qT,o.me,o.BC,o.cb,o.j4,o.JD,u.et,j]})}return n})();var V=l(8729),B=l(912);let M=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.$C({type:n});static#n=this.\u0275inj=t.G2t({imports:[m.MD,d.IQ,o.YN,d.IQ]})}return n})();const N=[{path:"offers",component:w,data:{title:"Offers"}}];let R=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.$C({type:n});static#n=this.\u0275inj=t.G2t({imports:[m.MD,B.G,M,V.iI.forChild(N),o.YN,o.X1]})}return n})()}}]);